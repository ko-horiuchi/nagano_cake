<%= render 'public/public_header' %>

<h3>注文履歴詳細</h3>

<h4>注文情報</h4>
  <table>
    <tbody>
      <tr>
        <td>注文日</td>
        <td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
      </tr>
      <tr>
        <td>配送先</td>
        <td><%= @order.postal_code %><%= @order.address %><%= @order.name %></td>
      </tr>
      <tr>
        <td>支払方法</td>
        <td><%= @order.payment_method %></td>
      </tr>
      <tr>
        <td>ステータス</td>
        <td></td>
      </tr>
    </tbody>
  </table>

<h4>請求情報</h4>
　  <table>
    <tbody>
      <tr>
        <td>商品合計</td>
        <td><% @order.order_details.each do |order_detail| %>
            <%  total_price = [order_detail.amount * order_detail.item.price] %>
            <%= total_price.sum %>
            <% end %>
        </td>
      </tr>
      <tr>
        <td>配送料</td>
        <td><%= @order.shipping_cost %></td>
      </tr>
      <tr>
        <td>ご請求額</td>
        <td><%= @order.total_payment %></td>
      </tr>
    </tbody>
  </table>

<h4>注文内容</h4>
 <table>
    <thead>
      <tr>
        <th>商品</th>
        <th>単価</th>
        <th>個数</th>
        <th>小計</th>
      </tr>
    </thead>

    <tbody>
      <% total_price = 0 %>
      <% @order.order_details.each do |order_detail| %>
        <tr>
          <td><%= order_detail.item.name %></td>
          <td><%= order_detail.item.price %></td>
          <td><%= order_detail.amount %></td>
          <td><%= order_detail.amount * order_detail.item.price %></td>
        </tr>
        <% end %>
    </tbody>
  </table>